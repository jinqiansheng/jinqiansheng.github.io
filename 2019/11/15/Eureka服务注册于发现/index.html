<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="金乾胜的个人微博"><meta name="keywords" content="java,jqs,金乾胜,jinqiansheng"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" type="text/css" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.4"><title>Eureka服务注册于发现 | 金乾胜</title><meta name="generator" content="Hexo 4.0.0"><link rel="alternate" href="/atom.xml" title="金乾胜" type="application/atom+xml">
</head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Eureka服务注册于发现</h1><a id="logo" href="/.">金乾胜</a><p class="description">榔头，榔头，有谁看见我的榔头了？</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Eureka服务注册于发现</h1><div class="post-meta"><a href="/2019/11/15/Eureka%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%BA%8E%E5%8F%91%E7%8E%B0/#comments" class="comment-count"></a><p><span class="date">Nov 15, 2019</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p><font color=#FF0000 >Eureka用于实现服务注册和发现，</font>是Netflix的一个子模块，也是核心模块之一。Eureka是一个极具Rest的服务，用于定位服务，以实现云端中间层服务发现和故障转移。服务注册于发现对于微服务架构来说是非常重要的，有了服务发现与注册，只需要使用服务器的标识符，就可以访问到服务，而不需要修改服务调用的配置文件。功能类似于dubbo的注册中心，比如Zookeeper。</br><br>Eureka采用了C-S的设计架构，Eureka Server 作为服务注册功能的服务器，是服务的注册中心，而系统中的其他微服务，使用Eureka的客户端连接到Eureka Server并维持心跳连接。这样系统的维护人员就可以通过Eureka Server来监控系统中各个微服务是否正常运行。SpringCloud的一些其他的模块(比如Zuul)就可以通过Eureka Server来发现系统中的其他微服务，并执行相关逻辑。</br><br><strong><font color=#FF0000 >简单来说就是负责发现和注册微服务，并通过Eureka Server维持各个微服务之间的心跳连接。</font></strong></p>
<h4 id="两大组件："><a href="#两大组件：" class="headerlink" title="两大组件："></a>两大组件：</h4><p><strong>Eureka Server：</strong><br>提供注册服务,各个节点启动后，会在EurekaServer中进行注册，这样EurekaServer中的服务注册表中将会存储所以可用服务节点的信息，服务节点的信息可以在界面中直观的看到。</p>
<p><strong>Eureka Client：</strong> 是一个Java客户端，用于简化Eureka Server的交互，客户端同时也具备一个内置、使用轮询负载算法的负载均衡器。再应用启动后，将会向Eureka Server发送心跳（默认周期是30秒）。如果Eureka Server在多个心跳周期内没有接收到某个节点的心跳，EurekaServer将会从服务注册表中把这个服务节点移除（默认90秒）</p>
<h4 id="Eureka对比Zookeeper的优点："><a href="#Eureka对比Zookeeper的优点：" class="headerlink" title="Eureka对比Zookeeper的优点："></a>Eureka对比Zookeeper的优点：</h4><p>在CAP的理论中,一个分布式系统不能同时满足C（一致性）、A（可用性）、P（分区容错性）。由于分区容错性P在分布式系统中必须要保证，因此只能在A和C之间进行权衡。</p>
<blockquote>
CAP原则又称CAP定理，指的是在一个分布式系统中， Consistency（一致性）、         Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。
</blockquote>
<blockquote>
<strong>一致性（C）：</strong>
在分布式系统中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）
</blockquote>
<blockquote>
<strong>可用性（A）：</strong>
在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。（对数据更新具备高可用性）
</blockquote>
<blockquote>
<strong>分区容忍性（P）：</strong>
以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。
</blockquote>
<blockquote>
CAP原则的精髓就是要么AP，要么CP，要么AC，但是不存在CAP。如果在某个分布式系统中数据无副本， 那么系统必然满足强一致性条件， 因为只有独一数据，不会出现数据不一致的情况，此时C和P两要素具备，但是如果系统发生了网络分区状况或者宕机，必然导致某些数据不可以访问，此时可用性条件就不能被满足，即在此情况下获得了CP系统，但是CAP不可同时满足 。
因此在进行分布式架构设计时，必须做出取舍。当前一般是通过分布式缓存中各节点的最终一致性来提高系统的性能，通过使用多节点之间的数据异步复制技术来实现集群化的数据一致性。通常使用类似 memcached 之类的 NOSQL 作为实现手段。虽然 memcached 也可以是分布式集群环境的，但是对于一份数据来说，它总是存储在某一台 memcached 服务器上。如果发生网络故障或是服务器死机，则存储在这台服务器上的所有数据都将不可访问。由于数据是存储在内存中的，重启服务器，将导致数据全部丢失。当然也可以自己实现一套机制，用来在分布式 memcached 之间进行数据的同步和持久化，但是实现难度是非常大的 。
</blockquote>

<p><strong><font color=#FF0000 >Zookeeper保证的是CP</font></strong><br>服务注册功能对一致性要求高，当master节点因为网络故障和其他节点失去联系时，剩余节点会重新进行Leader选举。这个时间持续30~120s，选举期间整个zk集群为不可用的，导致选举期间服务注册瘫痪。<br><strong><font color=#FF0000 >Eureka则是AP</font></strong><br>优先保证可用性，Eureka各个节点都是平等的，如果某几个几点故障，只要有一台Eureka在，就能保证注册服务可用，只不过查到的信息可能不是最新的，而Eureka的自我保护机制，如果在15分钟内超过85的节点都没有正常心跳，那么Eureka就认为客户端与注册中心出现网络故障，会出现以下几种情况</p>
<ol>
<li>Eureka不在从注册列表中移除因为长时间没有收到心跳而应该过期的服务</li>
<li>Eureka仍然能够接受新的服务注册和查询请求，但不会同步到其他节点，只保证当前节点依然可用</li>
<li>当网络稳定时，当前实例新注册的信息会同步到其他节点</li>
</ol>
<p><strong><font color=#FF0000 >Eureka可以很好的应对网络故障导致的部分节点失去联系的情况，而不会像Zookeeper那样使整个注册服务瘫痪。</font></strong></p>
<h4 id="EurekaServer使用"><a href="#EurekaServer使用" class="headerlink" title="EurekaServer使用"></a>EurekaServer使用</h4><p><strong>pom引入jar包</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">```  </span><br><span class="line">**yml加入**</span><br><span class="line">``` yml</span><br><span class="line">eureka: </span><br><span class="line">  instance:</span><br><span class="line">    hostname: eureka7001.com #eureka服务端的实例名称</span><br><span class="line">  client: </span><br><span class="line">    register-with-eureka: false     #false表示不向注册中心注册自己。</span><br><span class="line">    fetch-registry: false     #false表示自己端就是注册中心，我的职责就是维护服务实例，并不需要去检索服务</span><br><span class="line">    service-url: </span><br><span class="line">      defaultZone: http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/ </span><br><span class="line">```  </span><br><span class="line">**启动类加入注解启用**</span><br><span class="line">``` java</span><br><span class="line">@SpringBootApplication</span><br><span class="line">@EnableEurekaServer</span><br><span class="line">public class EurekaServer_App &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(EurekaServer_App.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line">#### EurekaClient 使用</span><br><span class="line">**pom引入jar包**</span><br><span class="line">``` xml</span><br><span class="line"><span class="comment">&lt;!-- 将微服务provider侧注册进eureka --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">```  </span><br><span class="line">**yml加入**</span><br><span class="line">``` yml</span><br><span class="line">eureka:</span><br><span class="line">  client: #客户端注册进eureka服务列表内</span><br><span class="line">    service-url: </span><br><span class="line">      defaultZone: http://localhost:7001/eureka #EurekaServer的地址</span><br><span class="line">  instance:</span><br><span class="line">    instance-id: microservicecloud-dept8001 #别名</span><br><span class="line">    prefer-ip-address: true     #访问路径可以显示IP地址</span><br></pre></td></tr></table></figure>
<p><strong>启动类加入注解注册</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaClient_App</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(EurekaClient_App <span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line">#### 服务提供者加入info监控信息</span><br><span class="line">**父maven项目加入**</span><br><span class="line">``` xml</span><br><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;finalName&gt;microservicecloud&lt;/finalName&gt;</span><br><span class="line">    &lt;resources&gt;</span><br><span class="line">        &lt;resource&gt;</span><br><span class="line">            &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">            &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">        &lt;/resource&gt;</span><br><span class="line">    &lt;/resources&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;configuration&gt;</span><br><span class="line">                &lt;delimiters&gt;</span><br><span class="line">                    &lt;delimit&gt;$&lt;/delimit&gt;</span><br><span class="line">                &lt;/delimiters&gt;</span><br><span class="line">            &lt;/configuration&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br><span class="line">```  </span><br><span class="line">**pom加入**</span><br><span class="line">``` xml</span><br><span class="line">&lt;!-- actuator监控信息完善 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p><strong>yml加入</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info:</span> <span class="comment">#点击别名页面所显示的说明</span></span><br><span class="line">   <span class="attr">app.name:</span> <span class="string">atguigu-microservicecloud</span> </span><br><span class="line">   <span class="attr">company.name:</span> <span class="string">www.atguigu.com</span></span><br><span class="line">   <span class="attr">build.artifactId:</span> <span class="string">$project.artifactId$</span></span><br><span class="line">   <span class="attr">build.version:</span> <span class="string">$project.version$</span>  </span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="comment">#### Eureka自我保护机制</span></span><br><span class="line"><span class="string">某时刻某一微服务不可用了，eureka不会立刻清理，依旧会对该微服务的信息进行保存。</span>  </span><br><span class="line"><span class="string">默认情况下，如果EurekaServer在一定时间内没有接收到某个微服务实例的心跳，EurekaServer将会注销该实例，（默认90秒），但是当网络分区故障发生时，微服务与EurekaServer之间无法正常通信，Eureka会通过自我保护机制解决这个问题，一旦进入该模式，EurekaServer就会保护服务注册表中的信息，不再删除服务祖册表中的数据（也就是不会注销任何微服务）。当网络故障恢复后，该EurekaServer节点会自动退出自我保护模式。</span>  </span><br><span class="line"><span class="string">自我保护模式中，EureKa</span> <span class="string">Server会保护服务注册表中的信息，不再注销任何服务实例。当它收到心跳数重新恢复到阀值以上时，该EurekaServer</span> <span class="string">节点会自动退出自我保护模式。</span>  </span><br><span class="line"></span><br><span class="line"><span class="string">**&lt;font</span> <span class="string">color=#FF0000</span> <span class="string">&gt;总的来说就是在触发EurekaServer的保护模式后，它宁可保留错误的服务注册信息，也不会盲目注销任何可能健康的服务实例。&lt;/font&gt;**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 禁用自我保护模式</span></span><br><span class="line"><span class="string">**Eureka</span> <span class="string">Server端**</span></span><br><span class="line"><span class="string">```</span> <span class="string">properties</span></span><br><span class="line"><span class="string">eureka.server.enable-self-preservation</span> <span class="comment">#设为false，关闭自我保护</span></span><br><span class="line"><span class="string">eureka.server.eviction-interval-timer-in-ms</span> <span class="comment">#清理间隔（单位毫秒，默认是60*1000）</span></span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="string">**Eureka</span> <span class="string">Client端**</span></span><br><span class="line"><span class="string">```</span> <span class="string">properties</span></span><br><span class="line"><span class="string">eureka.client.healthcheck.enabled</span> <span class="comment">#开启健康检查（需要spring-boot-starter-actuator依赖）</span></span><br><span class="line"><span class="string">eureka.instance.lease-renewal-interval-in-seconds</span> <span class="comment">#续约更新时间间隔（默认30秒）</span></span><br><span class="line"><span class="string">eureka.instance.lease-expiration-duration-in-seconds</span> <span class="comment">#续约到期时间（默认90秒</span></span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="comment">#### Discovery服务发现</span></span><br><span class="line"><span class="string">用于发现服务提供者</span></span><br><span class="line"><span class="string">**主启动类上引用**</span></span><br><span class="line"><span class="string">```</span> <span class="string">java</span></span><br><span class="line"><span class="string">@SpringBootApplication</span></span><br><span class="line"><span class="string">@EnableDiscoveryClient</span> <span class="string">//服务发现</span></span><br><span class="line"><span class="string">public</span> <span class="string">class</span> <span class="string">EurekaClient_App</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line">    <span class="string">public</span> <span class="string">static</span> <span class="string">void</span> <span class="string">main(String[]</span> <span class="string">args)</span></span><br><span class="line">    <span class="string">&#123;</span></span><br><span class="line">        <span class="string">SpringApplication.run(EurekaClient_App.class,</span> <span class="string">args);</span></span><br><span class="line">    <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="string">**调用代码使用示例**</span></span><br><span class="line"><span class="string">```</span> <span class="string">java</span></span><br><span class="line"><span class="string">@Autowired</span></span><br><span class="line"><span class="string">private</span> <span class="string">DiscoveryClient</span> <span class="string">client;</span></span><br><span class="line"><span class="string">public</span> <span class="string">Object</span> <span class="string">discovery()</span></span><br><span class="line">    <span class="string">&#123;</span></span><br><span class="line">        <span class="string">List&lt;String&gt;</span> <span class="string">list</span> <span class="string">=</span> <span class="string">client.getServices();</span></span><br><span class="line">        <span class="string">System.out.println("**********"</span> <span class="string">+</span> <span class="string">list);</span></span><br><span class="line"></span><br><span class="line">        <span class="string">List&lt;ServiceInstance&gt;</span> <span class="string">srvList</span> <span class="string">=</span> <span class="string">client.getInstances("MICROSERVICECLOUD-DEPT");</span></span><br><span class="line">        <span class="string">for</span> <span class="string">(ServiceInstance</span> <span class="attr">element :</span> <span class="string">srvList)</span> <span class="string">&#123;</span></span><br><span class="line">            <span class="string">System.out.println(element.getServiceId()</span> <span class="string">+</span> <span class="string">"\t"</span> <span class="string">+</span> <span class="string">element.getHost()</span> <span class="string">+</span> <span class="string">"\t"</span> <span class="string">+</span> <span class="string">element.getPort()</span> <span class="string">+</span> <span class="string">"\t"</span></span><br><span class="line">                    <span class="string">+</span> <span class="string">element.getUri());</span></span><br><span class="line">        <span class="string">&#125;</span></span><br><span class="line">        <span class="string">return</span> <span class="string">this.client;</span></span><br><span class="line">    <span class="string">&#125;</span></span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="comment">#### 集群配置</span></span><br><span class="line"><span class="string">多个EurekaServer可以互相牵手形成集群，某一个注册中心因为特殊原因发生故障服务提供者无法注册时会向集群中的别的EurekaServer注册，当故障解除后集群中的EurekaServer再进行同步注册信息。</span>  </span><br><span class="line"><span class="string">**在EurekaServer</span> <span class="string">yml中配置牵手**</span></span><br><span class="line"><span class="string">```</span> <span class="string">properties</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/</span></span><br><span class="line"><span class="string">```</span>  </span><br><span class="line"><span class="string">**在Eureka</span> <span class="string">client中向集群的所有EurekaServer注册</span> <span class="string">yml配置如下**</span></span><br><span class="line"><span class="string">```</span> <span class="string">properties</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br></pre></td></tr></table></figure></div><div class="post-copyright"><blockquote><p>原文作者: 金乾胜</p><p>原文链接: <a href="https://jinqiansheng.github.io/2019/11/15/Eureka服务注册于发现/">https://jinqiansheng.github.io/2019/11/15/Eureka服务注册于发现/</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a><a href="/tags/SpringCloud/">SpringCloud</a><a href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2019/11/16/Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="pre">Ribbon负载均衡</a><a href="/2019/11/14/SpringCloud%E6%A6%82%E8%BF%B0/" class="next">SpringCloud概述</a></div><div id="comments"><div id="container"><script type="text/javascript" src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.4"></script><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.4"></script><script>var gitalk = new Gitalk({
  clientID: '26ab90222c429429007a',
  clientSecret: '371da8f5ba7f6e4ba89ac3248ce4dd15a38f61b9',
  repo: 'jinqiansheng.github.io',
  owner: 'jinqiansheng',
  admin: ['jinqiansheng'],
  id: md5(window.location.pathname),
  distractionFreeMode: false,
  language: 'zh-CN',
  pagerDirection: 'last'
})
gitalk.render('container')</script></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#两大组件："><span class="toc-text">两大组件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Eureka对比Zookeeper的优点："><span class="toc-text">Eureka对比Zookeeper的优点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EurekaServer使用"><span class="toc-text">EurekaServer使用</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/11/20/SpringCloud%20Config%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/">SpringCloud Config分布式配置中心</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/19/Zuul%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3/">Zuul路由网关</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/18/Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/">Hystrix断路器</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/17/Feign%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">Feign负载均衡</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/16/Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">Ribbon负载均衡</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/15/Eureka%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%BA%8E%E5%8F%91%E7%8E%B0/">Eureka服务注册于发现</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/14/SpringCloud%E6%A6%82%E8%BF%B0/">SpringCloud概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/13/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A6%82%E8%BF%B0/">微服务概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/12/java8%E6%96%B0%E7%89%B9%E6%80%A7/">java8新特性</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 15px;">微服务</a> <a href="/tags/SpringCloud/" style="font-size: 15px;">SpringCloud</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">9</span></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">金乾胜.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?15169873357bbc74e70db9b309cc5d99";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>